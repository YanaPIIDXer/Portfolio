version: '3'
services:
    # Database(MySQL)
    db:
        image: mysql:5.7
        command: mysqld --character-set-server=utf8 --collation-server=utf8_unicode_ci --innodb-use-native-aio=0
        ports:
            - "3306:3306"
        volumes:
            - /MySQL/data:/var/lib/mysql
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_USER: develop
            MYSQL_PASSWORD: develop

    # Redmine
    redmine:
        image: redmine
        ports:
            - 4000:3000
        volumes:
            - ./Redmine/Plugins:/usr/src/redmine/plugins
            - ./Redmine/Themes:/usr/src/redmine/themes
        environment:
            REDMINE_DB_MYSQL: redmine_db
            REDMINE_DB_PASSWORD: redmine
        depends_on:
            - redmine_db

    # Redmine DB
    redmine_db:
        image: mysql:5.7
        command: mysqld --character-set-server=utf8 --collation-server=utf8_unicode_ci --explicit_defaults_for_timestamp --innodb-use-native-aio=0
        ports:
            - "3307:3306"
        environment:
            MYSQL_ROOT_PASSWORD: redmine
            MYSQL_DATABASE: redmine
        volumes:
            - ./Redmine/DB:/var/lib/mysql
